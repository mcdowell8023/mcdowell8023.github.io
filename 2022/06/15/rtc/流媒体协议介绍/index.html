<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>常见流媒体协议介绍 | mcdowell blog</title><meta name="description" content="本文 主要整理自 https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;496823042   前置 整理下常见 流媒体协议 RTP、RTSP、RTMP、HLS、FLV、SRT、WebRTC 一图胜千言，但是注意，图中 的 MP4&#x2F;FLV指的是 http-flv 和 http-mp4。 这里说的还是流媒体协议，不是封装格式。  从上面我们知道：  基于 UDP 的 流媒体协议 有 RTP、R"><meta property="og:type" content="article"><meta property="og:title" content="常见流媒体协议介绍"><meta property="og:url" content="http://mcdowell8023.github.io/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/index.html"><meta property="og:site_name" content="mcdowell博客"><meta property="og:description" content="本文 主要整理自 https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;496823042   前置 整理下常见 流媒体协议 RTP、RTSP、RTMP、HLS、FLV、SRT、WebRTC 一图胜千言，但是注意，图中 的 MP4&#x2F;FLV指的是 http-flv 和 http-mp4。 这里说的还是流媒体协议，不是封装格式。  从上面我们知道：  基于 UDP 的 流媒体协议 有 RTP、R"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/streaming_media.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/network_architecture.jpg"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/rtsp_rtp.jpg"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/rtsp.jpg"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/rtp.jpg"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_rtmp_1.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_rtmp_2.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_flv_1.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_flv_2.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_hls_1.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/live_hls_2.png"><meta property="og:image" content="http://mcdowell8023.github.io/images/rtc/srt.jpg"><meta property="article:published_time" content="2022-06-15T10:24:30.000Z"><meta property="article:modified_time" content="2025-03-09T07:55:41.196Z"><meta property="article:author" content="mcdowell"><meta property="article:tag" content="追本溯源"><meta property="article:tag" content="直播"><meta property="article:tag" content="音视频"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://mcdowell8023.github.io/images/rtc/streaming_media.png"><link rel="canonical" href="http://mcdowell8023.github.io/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/index.html"><link rel="alternate" href="/atom.xml" title="mcdowell博客" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="//cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"></head><body class="main-center theme-green" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/mcdowell8023" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">mcdowell</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">Web 前端 &amp; 90后</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 北京, 中国</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/mcdowell8023" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="https://www.linkedin.com/in/%E6%98%BE%E8%B6%85-%E5%AD%9F-688582107/" target="_blank" title="Linkedin" data-toggle="tooltip" data-placement="top"><i class="icon icon-linkedin"></i></a></li><li><a href="https://mcdowell8023.gitee.io/" target="_blank" title="Coding" data-toggle="tooltip" data-placement="top"><i class="icon icon-coding"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p>但行好事莫问前程</p></div></div></div></div><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80/">基础</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%B8%96/">技术帖</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8B%93%E5%B1%95/">拓展</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B8%A9%E5%9D%91/">踩坑</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE%E6%94%B9%E9%80%A0/">项目改造</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/Docker/" style="font-size:13.11px">Docker</a> <a href="/tags/HarmonyOS/" style="font-size:13.22px">HarmonyOS</a> <a href="/tags/SEO/" style="font-size:13px">SEO</a> <a href="/tags/ant-design/" style="font-size:13px">ant-design</a> <a href="/tags/api/" style="font-size:13px">api</a> <a href="/tags/git/" style="font-size:13.11px">git</a> <a href="/tags/hexoBlog/" style="font-size:13.11px">hexoBlog</a> <a href="/tags/http/" style="font-size:13.33px">http</a> <a href="/tags/js%E5%9F%BA%E7%A1%80/" style="font-size:13.56px">js基础</a> <a href="/tags/react/" style="font-size:13px">react</a> <a href="/tags/svn/" style="font-size:13px">svn</a> <a href="/tags/vue/" style="font-size:13px">vue</a> <a href="/tags/web/" style="font-size:13.44px">web</a> <a href="/tags/webrtc/" style="font-size:13.67px">webrtc</a> <a href="/tags/web%E7%A7%BB%E5%8A%A8%E7%AB%AF/" style="font-size:13px">web移动端</a> <a href="/tags/%E4%BC%98%E5%8C%96/" style="font-size:13.44px">优化</a> <a href="/tags/%E5%85%BC%E5%AE%B9/" style="font-size:13px">兼容</a> <a href="/tags/%E5%8A%A8%E7%94%BB/" style="font-size:13px">动画</a> <a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size:13px">命令</a> <a href="/tags/%E5%AE%89%E5%8D%93/" style="font-size:13px">安卓</a> <a href="/tags/%E6%8B%93%E5%B1%95/" style="font-size:13.22px">拓展</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" style="font-size:13px">浏览器</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" style="font-size:13px">环境变量</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size:13.89px">直播</a> <a href="/tags/%E7%A6%BB%E7%BA%BF%E5%8C%85/" style="font-size:13px">离线包</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size:14px">笔记</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.11px">脚本</a> <a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size:13.11px">调试</a> <a href="/tags/%E8%B8%A9%E5%9D%91/" style="font-size:13px">踩坑</a> <a href="/tags/%E8%BF%BD%E6%9C%AC%E6%BA%AF%E6%BA%90/" style="font-size:13.78px">追本溯源</a> <a href="/tags/%E9%80%9F%E6%9F%A5/" style="font-size:13px">速查</a> <a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/" style="font-size:13.11px">音视频</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">三月 2025</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">一月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">八月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">七月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">六月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">四月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">2</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a></p><p class="item-title"><a href="/2025/03/03/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%BC%80%E5%8F%91%E6%9D%82%E8%AE%B0/" class="title">HarmonyOS学习笔记-开发杂记</a></p><p class="item-date"><time datetime="2025-03-03T12:33:27.000Z" itemprop="datePublished">2025-03-03</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a></p><p class="item-title"><a href="/2025/03/02/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%20-%20har%20%E5%8C%85%E6%9E%84%E5%BB%BA&&%E5%8F%91%E5%B8%83/" class="title">HarmonyOS学习笔记 - har 包构建&amp;&amp;发布</a></p><p class="item-date"><time datetime="2025-03-02T10:26:47.000Z" itemprop="datePublished">2025-03-02</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a></p><p class="item-title"><a href="/2025/01/16/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/HarmonyOS%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%88%9D%E8%AF%86/" class="title">HarmonyOS学习笔记-初识</a></p><p class="item-date"><time datetime="2025-01-16T00:26:17.000Z" itemprop="datePublished">2025-01-16</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%B8%96/">技术帖</a></p><p class="item-title"><a href="/2024/11/15/web/%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96-7.h5%E7%A6%BB%E7%BA%BFZIP%E5%8C%85/" class="title">前端项目优化-7.h5离线ZIP包</a></p><p class="item-date"><time datetime="2024-11-15T06:37:34.000Z" itemprop="datePublished">2024-11-15</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%B8%96/">技术帖</a></p><p class="item-title"><a href="/2024/08/27/web/%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96-6.SEO%E6%8C%87%E5%8D%97/" class="title">前端项目优化-6.SEO指南</a></p><p class="item-date"><time datetime="2024-08-27T05:37:34.000Z" itemprop="datePublished">2024-08-27</time></p></div></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HarmonyOS/" rel="tag">HarmonyOS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEO/" rel="tag">SEO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ant-design/" rel="tag">ant-design</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/" rel="tag">api</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexoBlog/" rel="tag">hexoBlog</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js%E5%9F%BA%E7%A1%80/" rel="tag">js基础</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svn/" rel="tag">svn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webrtc/" rel="tag">webrtc</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E7%A7%BB%E5%8A%A8%E7%AB%AF/" rel="tag">web移动端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%98%E5%8C%96/" rel="tag">优化</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%BC%E5%AE%B9/" rel="tag">兼容</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E7%94%BB/" rel="tag">动画</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4/" rel="tag">命令</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%8D%93/" rel="tag">安卓</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%93%E5%B1%95/" rel="tag">拓展</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" rel="tag">浏览器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" rel="tag">环境变量</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%B4%E6%92%AD/" rel="tag">直播</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E7%BA%BF%E5%8C%85/" rel="tag">离线包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a><span class="tag-list-count">30</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%84%9A%E6%9C%AC/" rel="tag">脚本</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B8%A9%E5%9D%91/" rel="tag">踩坑</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%BD%E6%9C%AC%E6%BA%AF%E6%BA%90/" rel="tag">追本溯源</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/" rel="tag">音视频</a><span class="tag-list-count">2</span></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-rtc/流媒体协议介绍" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">常见流媒体协议介绍</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/" class="article-date"><time datetime="2022-06-15T10:24:30.000Z" itemprop="datePublished">2022-06-15</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%B8%96/">技术帖</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/%E7%9B%B4%E6%92%AD/" rel="tag">直播</a>, <a class="article-tag-link-link" href="/tags/%E8%BF%BD%E6%9C%AC%E6%BA%AF%E6%BA%90/" rel="tag">追本溯源</a>, <a class="article-tag-link-link" href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/" rel="tag">音视频</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><blockquote><p>本文 主要整理自 <a href="https://zhuanlan.zhihu.com/p/496823042">https://zhuanlan.zhihu.com/p/496823042</a></p></blockquote><h2 id="前置"><a class="markdownIt-Anchor" href="#前置"></a> 前置</h2><p>整理下常见 流媒体协议 <code>RTP、RTSP、RTMP、HLS、FLV、SRT、WebRTC</code></p><p>一图胜千言，但是注意，图中 的 <code>MP4/FLV</code>指的是 <code>http-flv</code> 和 <code>http-mp4</code>。 这里说的还是流媒体协议，<strong>不是封装格式</strong>。</p><p><img src="/images/rtc/streaming_media.png" alt="network_architecture.jpg"></p><p>从上面我们知道：</p><ul><li>基于 <strong>UDP</strong> 的 流媒体协议 有 <code>RTP</code>、<code>RTCP</code></li><li>基于 <strong>TCP</strong> 的 流媒体协议 有 <code>RTSP</code>、<code>RTMP</code>、<code>HTTP</code>、<code>HLS</code>、<code>http-flv</code>、<code>http-mp4</code></li></ul><blockquote><p><code>HLS</code>、<code>http-flv</code>、<code>http-mp4</code> 本身就是基于 http协议的。 后面会说到</p></blockquote><h2 id="从网络协议说起"><a class="markdownIt-Anchor" href="#从网络协议说起"></a> 从网络协议说起</h2><p>但是说流媒体协议就绕不开网络协议。我们要建立网络分层模型的概念，所有流媒体协议都有归属的层级，这个是理解、区分协议的基础。</p><p><img src="/images/rtc/network_architecture.jpg" alt="network_architecture.jpg"></p><p>流媒体协议需要根据目标场景，选择<code>TCP</code>/<code>UDP</code>，再进行应用层协议开发，这里就出现第一个概念，如何选择TCP/UDP？</p><h3 id="tcp和udp特点"><a class="markdownIt-Anchor" href="#tcp和udp特点"></a> <code>TCP</code>和<code>UDP</code>特点</h3><h4 id="tcp-传输的特点面向连接保序可靠"><a class="markdownIt-Anchor" href="#tcp-传输的特点面向连接保序可靠"></a> <code>TCP</code> 传输的特点：面向连接，保序，可靠</h4><ul><li><code>TCP</code>的协议栈完成了<code>拥塞控制</code>，<code>流量控制</code>，<code>乱序重排</code>，<code>丢包重传</code>等工作。</li><li>保证数据是有序可靠的。</li><li>适合强调<strong>数据完整性</strong> 的场景：如:文件下载，网页浏览，信令传输。</li></ul><h4 id="udp-传输特点面向无连接不保序不可靠连接"><a class="markdownIt-Anchor" href="#udp-传输特点面向无连接不保序不可靠连接"></a> <code>UDP</code> 传输特点：面向无连接，不保序，不可靠连接</h4><ul><li><code>UDP</code>协议 <code>面向无连接</code>，只是简单向对方<code>发送数据</code>，<strong>哪怕对方不存在</strong>。</li><li><code>协议简单</code>，所以<code>传输效率高</code>，<code>实时高、延迟低</code>。</li><li>适合强调<strong>实时性高</strong>的场景。如: 音视频传输，游戏等。</li></ul><blockquote><p>关于<strong>组播</strong>与<strong>广播</strong>，<strong>单播</strong></p><p><code>TCP</code> 面向连接，一定是点对点的，一定是两个主机来建立连接的，<strong>TCP肯定是单播</strong>。<br>只有<code>UDP</code>才会使用<strong>广播</strong>和<strong>组播</strong><br>一个主机要向网上的所有其它主机发送帧，这就是广播，<br>多播（组播）属于单播和广播之间，帧仅传送给属于多播组的多个主机。<br>在广播电视领域为了减少服务器压力，通常使用组播跟用户推流。如: <code>IPTV</code>，通常机顶盒通过光猫加入某个组播地址，接收 某个CDN的组播流。</p></blockquote><h5 id="从流媒体角度看"><a class="markdownIt-Anchor" href="#从流媒体角度看"></a> 从流媒体角度看</h5><ul><li><code>TCP</code>自身的<code>拥塞控制</code>机制、<code>传输数据延时大</code>，<code>队头阻塞</code>等问题，音视频的 <strong>实时传输</strong> 造成一定的困扰。</li><li><code>UDP</code>自身设计原因，公网传输<strong>丢包</strong>、<strong>乱序</strong>等极端情况，会导致客户端无法解码。</li></ul><p>所以对于流媒体传输，需要对<strong>运输层</strong><code>TCP/UDP协议</code>进行高层次的开发，以<strong>适应流媒体传输</strong>时的应用需求。</p><h2 id="常见流媒体协议"><a class="markdownIt-Anchor" href="#常见流媒体协议"></a> 常见流媒体协议</h2><h3 id="rtp-实时传输协议-与-rtcp"><a class="markdownIt-Anchor" href="#rtp-实时传输协议-与-rtcp"></a> <code>RTP</code> 实时传输协议 与 <code>RTCP</code></h3><blockquote><p><code>RTP</code> (Real-time Transport Protocol) 和<code>RTCP</code>(Real-time Transport Control Protocol) 都是 <strong>传输层协议</strong><br><code>RTCP</code>是<code>RTP</code>的控制部分,通常一起配合使用</p></blockquote><p>应用程序启动一个<code>RTP</code>会话时，将<code>占用两个端口</code>，分别供<code>RTP</code>和<code>RTCP</code>使用</p><ul><li><code>RTP</code> 使用 <strong>偶数端口号</strong> 收发数据,负责<strong>数据传输</strong><ul><li>通常创建在<code>UDP</code>上，但也能够在<code>TCP</code>或<code>ATM</code>等其余协议之上工作</li><li>基于<code>UDP</code>时，和<code>UDP</code>一样，并<strong>不提供任何传输可靠性的保证和流量的拥塞控制机制</strong>，<strong>无法保证实时性</strong></li><li><code>RTP</code> 在 <code>UDP</code> 基础上增加了 Header 头，包含 <strong>CSRC标识</strong>、<strong>时间戳</strong>、<strong>序列号</strong>等信息（用于<strong>配合</strong>完成 按序传输数据包提供可靠的保证）。</li></ul></li><li><code>RTCP</code> 使用 相邻的下一位<strong>奇数端口号</strong>,负责<strong>管理传输质量</strong>。<ul><li>负责 <strong>收集相关连接信息</strong>，<strong>实时监控数据传输和服务质量</strong>(控制辅助)</li><li><code>RTCP</code>来负责 完成 <code>RTP</code> 按序传输数据包提供可靠的保证，<strong>流量控制</strong>和<strong>拥塞控制</strong></li><li>在<code>RTP</code>会话期间，各参与者周期性地传送<code>RTCP</code>包，包中含有已<strong>发送包的数量</strong>、<strong>丢失包的数量</strong>等<code>统计信息</code>。服务器利用这些信息<code>动态地改变传输速率</code>，甚至<code>改变有效载荷类型</code>。</li></ul></li></ul><p><img src="/images/rtc/rtsp_rtp.jpg" alt="network_architecture.jpg"></p><h4 id="rtsp-实时流协议"><a class="markdownIt-Anchor" href="#rtsp-实时流协议"></a> RTSP 实时流协议</h4><ul><li>比<code>RTP</code>多了一个S的RTSP是<code>RealTime Streaming Potocol</code> 实时流协议。</li><li>基于<code>RTP</code>和<code>RTCP</code>之上的<strong>应用层协议</strong>。可选择<code>UDP</code>、<code>组播UDP</code>、<code>TCP</code>、<code>RTP</code>为传输机制。</li><li><strong>双向实时数据传输协议</strong>，它<strong>允许客户端向服务器端发送请求</strong>, 进行 回放、快进、倒退等操作</li><li>充当多媒体服务器的网络远程控制，使<strong>实时数据的远程控制</strong>成为可能。 比如，音频与视频的快进快退、中止、播放。</li><li>一般用作<strong>摄像头</strong>、<strong>监控</strong>等硬件设备的实时视频流观看与推送上</li><li>泛用性不足，现在的 浏览器都<strong>不支持RTSP的播放</strong></li></ul><p><img src="/images/rtc/rtsp.jpg" alt="network_architecture.jpg"></p><h3 id="rsvp-resource-reserve-protocol资源预订协议"><a class="markdownIt-Anchor" href="#rsvp-resource-reserve-protocol资源预订协议"></a> <code>RSVP</code> (Resource Reserve Protocol)资源预订协议</h3><ul><li>主要作用: 预留带宽,提升QoS(服务质量)</li><li>音频和视频数据流比传统数据对网络的<strong>延时更敏感</strong>，要在网络中传输高质量的音频、视频信息，除带宽要求以外，还需其余更多的条件。</li><li>使用<code>RSVP</code>预留一部分网络资源，能在一定程度上<strong>为流媒体的传输提供QoS保障</strong>。</li></ul><p><img src="/images/rtc/rtp.jpg" alt="network_architecture.jpg"></p><blockquote><p>RTP\RTCP\RTSP小结</p><ol><li><code>RTP</code>提供时间标志，序列号以及其余可以保证在实时数据传输时处理时间的方法。</li><li><code>RTCP</code>是<code>RTP</code>的控制部分，用来保证服务质量和成员管理。</li><li><code>RTSP</code>具体数据传输交给<code>RTP</code>,提供对流的远程控制。</li><li><code>RSVP</code>预留带宽,提升QoS。</li></ol></blockquote><h3 id="rtmpreal-time-messaging-protocol实时消息传输协议"><a class="markdownIt-Anchor" href="#rtmpreal-time-messaging-protocol实时消息传输协议"></a> RTMP（Real Time Messaging Protocol）实时消息传输协议</h3><ul><li>Adobe公司为<strong>Flash播放器</strong>和服务器之间开发的<strong>音视频数据传输</strong>的开放协议</li><li>传输<strong>flv</strong>或<strong>f4v</strong>封装格式 的 媒体流。</li><li>基于<code>TCP</code>协议，使用端口1935，能够<strong>保持长连接*，并提供</strong>低延时**(1-3秒)通信。【通常占用一个通道传输数据和指令，就能保证传输质量】</li><li>RTMP是目前<code>低延时直播</code>应用最普遍的协议，<strong>几乎全部编码器</strong>标准输出协议（H.265 不支持）</li><li>全部<code>CDN</code>支持的最好的<strong>直播分发协议</strong></li><li><strong>实际直播场景中</strong>： 由于浏览器摒弃了Flash播放器，所以一般只用作<code>直播源推流</code>、<code>推流到直播CDN</code>等场景。</li></ul><h4 id="缺点"><a class="markdownIt-Anchor" href="#缺点"></a> 缺点</h4><ul><li>协议太老: <code>HEVC/H.265/AV1</code>等视频格式都没有官方定义</li><li><strong>连接过程较长</strong>，需要 TCP三次握手 和 本身的<code>C0/S0</code>到<code>C2/S2</code>的三次握手，再加上 <code>建立连接 &gt; 建立流 &gt; 播放</code>, 完成一次<strong>建连9次会话</strong></li><li><strong>无法提供带宽自适应的算法</strong>: 拥塞控制完全依赖传输层TCP的拥塞控制算法来进行拥塞管理</li></ul><blockquote><p>因为<code>RTMP</code>是基于TCP之上的，所以也存在<strong>三次握手</strong>的要求，<br>另外<code>RTMP</code>还增加了<code>C0/S0</code>到<code>C2/S2</code>的三次握手。<br>播放<code>RTMP</code>协议的流媒体需要经过：握手 &gt; 建立连接 &gt; 建立流 &gt; 播放 [connection，createstream，play/publish]。</p></blockquote><blockquote><p><code>RTMP</code>包括: <code>RTMP</code>基本协议及<code>RTMPT</code>/<code>RTMPS</code>/<code>RTMPE</code>等多种变种</p><ul><li><code>RTMPT</code>： 封装在<code>HTTP</code>请求之上，可<strong>穿透防火墙</strong>；</li><li><code>RTMPS</code>： 在<code>RTMPT</code>基础上 增加了<strong>TLS/SSL的安全功能</strong>；</li><li><code>RTMPE</code>： 在<code>RTMP</code>的基础上 增加了<strong>加密功能</strong>。</li></ul></blockquote><h4 id="落地"><a class="markdownIt-Anchor" href="#落地"></a> 落地</h4><h5 id="需要流媒体服务软件"><a class="markdownIt-Anchor" href="#需要流媒体服务软件"></a> 需要流媒体服务软件</h5><p>RTMP协议需要特定的<code>流媒体服务软件</code>，如<code>SRS</code>、加入了<code>RTMP插件的Nginx</code>等。此类流媒体服务软件实际上就是<code>音视频数据的中转站</code>，数据一般只在内存中循环覆盖，不会写入磁盘。<br><img src="/images/rtc/live_rtmp_1.png" alt=""></p><h5 id="强制切片机制"><a class="markdownIt-Anchor" href="#强制切片机制"></a> 强制切片机制</h5><p><code>RTMP</code>，在封装音视频数据时会强制切片，限制每个数据包的大小。<br>强制切片也一定程度保证了实时性。<br>有一定的弱网抵抗能力，因为数据包都不大，当失败时，<strong>重新成本小</strong>，但也 由于<strong>合并数据包</strong>会加大CPU压力，所以是有一定的性能消耗的。<br><img src="/images/rtc/live_rtmp_2.png" alt=""></p><h3 id="http-flv"><a class="markdownIt-Anchor" href="#http-flv"></a> HTTP-FLV</h3><blockquote><ul><li>可以简单地理解为<code>HTTP协议版本</code>的<code>RTMP</code></li><li><code>HTTP-FLV</code> 与 <code>RTMP</code>基本一样，都是建立在<code>FLV</code>封装之上的。</li><li>功能和工作原理上是相似,也有 类似 <code>RTMP</code><strong>切片数据功能</strong></li><li>注意: <code>HTTP-FLV</code> 虽然是基于<code>HTTP</code>协议的，但是 是<strong>长链接</strong></li></ul></blockquote><h4 id="不同点"><a class="markdownIt-Anchor" href="#不同点"></a> 不同点</h4><ul><li><code>RTMP</code>一般用作<strong>直播源推流</strong></li><li><code>HTTP-FLV</code>一般用作<strong>直播拉流观看</strong>(相对<strong>略高于RTMP</strong>)；</li></ul><blockquote><p>优点在于: 在浏览器中 借助 <code>flvjs</code> 可以<strong>在浏览器中实现播放</strong>。</p></blockquote><h4 id="落地-2"><a class="markdownIt-Anchor" href="#落地-2"></a> 落地</h4><p><code>HTTP-FLV</code>协议 同样需要<code>特定的流媒体服务软件</code>，如加入了<code>HTTP-FLV插件的Nginx</code>等。</p><blockquote><p>Nginx的<code>HTTP-FLV插件</code>是包含 <code>RTMP</code>功能的，所以一般<code>HTTP-FLV</code>的流媒体服务，推流是以<code>RTMP</code>协议，拉流是用<code>HTTP-FLV</code>协议。</p></blockquote><p><img src="/images/rtc/live_flv_1.png" alt=""></p><p><img src="/images/rtc/live_flv_2.png" alt=""></p><h3 id="hlshttp-live-streaming"><a class="markdownIt-Anchor" href="#hlshttp-live-streaming"></a> HLS（HTTP Live Streaming）</h3><ul><li>由Apple公司提出的基于<code>短连接HTTP</code>的媒体流传输协议</li><li>严格意义上讲，HLS协议并不是流式协议: 本质是 <strong>通过HTTP协议下载静态文件</strong></li><li>网络兼容好： 基于<code>HTTP协议</code>，能方便<strong>穿透防火墙</strong>或<strong>代理服务器</strong>，CDN支持良好</li><li>平台播放兼容好： ios 安卓都支持，PC web safari 都支持, 其他浏览器 可以使用 <code>hls.js</code> 播放</li></ul><h4 id="hls协议实现播放的过程"><a class="markdownIt-Anchor" href="#hls协议实现播放的过程"></a> HLS协议实现播放的过程</h4><ul><li>HLS协议 包含<code>.m3u8</code>索引文件 和 多个很短的<code>.ts</code>媒体文件。</li><li>客户端获取到索引文件后，通过http请求获取到<code>.ts</code>文件，下载到本地磁盘，再根据索引顺序播放。</li></ul><h5 id="一个-m3u8文件的内容如下"><a class="markdownIt-Anchor" href="#一个-m3u8文件的内容如下"></a> 一个 m3u8文件的内容如下</h5><p><a href="https://yunqivedio.alicdn.com/2017yq/v2/0x0/96d79d3f5400514a6883869399708e11/96d79d3f5400514a6883869399708e11.m3u8">m3u8示例</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#EXTM3U # 每个M3U8文件第一行必须是这个tag。</span></span><br><span class="line"><span class="comment">#EXT-X-VERSION:3 # 表示 HLS 的协议版本号，该标签与流媒体的兼容性相关</span></span><br><span class="line"><span class="comment">#EXT-X-MEDIA-SEQUENCE:0 # 表示播放列表第一个 URL 片段文件的序列号。</span></span><br><span class="line"><span class="comment">#EXT-X-ALLOW-CACHE:YES</span></span><br><span class="line"><span class="comment">#EXT-X-TARGETDURATION:6 # 表示每个视频分段最大的时长（单位秒）</span></span><br><span class="line"><span class="comment">#EXTINF:3.000 #表示其后 URL 指定的媒体片段时长（单位为秒）</span></span><br><span class="line">alilive-E_2_3-1507867721-471441600-1920x1080-1165-3000.ts <span class="comment"># 表示媒体片段的 URL</span></span><br><span class="line"><span class="comment">#EXTINF:3.000</span></span><br><span class="line">alilive-E_2_3-1507867721-471711600-1920x1080-1165-3000.ts</span><br><span class="line"><span class="comment">#EXTINF:3.000</span></span><br><span class="line">alilive-E_2_3-1507867721-471981600-1920x1080-1165-3000.ts</span><br><span class="line"><span class="comment">#EXTINF:3.000</span></span><br><span class="line">alilive-E_2_3-1507867721-472251600-1920x1080-1165-3000.ts</span><br></pre></td></tr></table></figure><blockquote><p>此外 HLS协议的.m3u8索引文件支持二级索引，就是高清、标清、流畅等多个观看地址可以整合到一个索引文件<br><a href="https://www.cnblogs.com/mq0036/p/14961793.html">m3u8 文件格式详解</a></p></blockquote><blockquote><p>与HLS协议类似的还有<code>MPEG-DASH协议</code>工作原理都是差不多的，只是局部标准不一样</p></blockquote><h4 id="缺点-2"><a class="markdownIt-Anchor" href="#缺点-2"></a> 缺点</h4><ul><li><strong>延时较高</strong>：因为使用HTTP短连接，不断的与server建立连接，TCP的三次握手，四次挥手，交互耗时长。难以用到时延要求更严格的直播场景。</li><li><strong>海量碎片</strong>：HLS切片一般较小，海量碎片在文件分发、一致性缓存都有较大挑战。</li></ul><h4 id="落地-点播"><a class="markdownIt-Anchor" href="#落地-点播"></a> 落地-点播</h4><p><strong>不需要特殊的流媒体服务软件</strong>，使用Nginx等HTTP服务就可以了</p><ul><li>.m3u8索引文件会记录所有的碎片视频文件地址，HLS在点播的场景下，优势是更加明显的。</li><li>由于HLS的相关文件是无状态的静态文件，且每个文件的大小是有限的，所以<strong>负载均衡、CDN加速的效果更佳明显</strong>。</li><li>HLS协议的<strong>点播视频</strong>，会比<code>.mp4</code>、<code>.flv</code>的视频更快地播放出来，且在加载中跳转视频也会更加顺滑。</li></ul><p><img src="/images/rtc/live_hls_1.png" alt=""></p><h4 id="落地-直播"><a class="markdownIt-Anchor" href="#落地-直播"></a> 落地-直播</h4><ul><li><strong>转码软件</strong>可以直接<strong>生成HLS相关文件到磁盘</strong>，客户端 <strong>通过HTTP服务下载文件</strong>即可。</li><li>在Nginx加入<code>RTMP插件</code>，转码软件以<code>RTMP协议</code>推流到Nginx，再<code>由Nginx生成HLS相关文件</code>。推荐：前期研发 和 后期<strong>对接直播CDN的过度更加顺滑</strong>。</li></ul><p><img src="/images/rtc/live_hls_2.png" alt=""></p><h3 id="http-mp4"><a class="markdownIt-Anchor" href="#http-mp4"></a> http-mp4</h3><ul><li>是一种 HTTP 伪流媒体,其实不算是流媒体协议，而是基于<code>HTTP协议</code>的<strong>点播协议</strong>。</li><li>本质是需要 <code>特殊的MP4-fMP4</code> 格式的文件，通过<code>HTTP协议</code>下载到进行播放，只是客户端可以<strong>边下边播</strong>。</li><li>这点 通常用于 网站的 视频播放的优化。</li></ul><h4 id="实现的条件"><a class="markdownIt-Anchor" href="#实现的条件"></a> 实现的条件</h4><ol><li>必须将 moov 放在 mdat 前面。可以通过 ffmpeg 指定参数 -movflags faststart 进行移动。</li><li>HTTP 请求返回的 Content-Type 必须是 video/mp4 。</li><li>服务器必须支持 HTTP 1.1 的 Range 。</li><li>确保服务器没有对 MP4 文件进行 gzip 压缩，不然怎么读取 moov 啊。</li></ol><p><a href="https://blog.qiusuo.im/blog/2015/02/05/play-mp4-using-http/">使用HTTP流播放MP4</a><br><a href="https://d.cellmean.com/p/9ef9986157a9">Nginx 中实现 MP4 视频的边下边播</a></p><h4 id="特殊的mp4-fmp4"><a class="markdownIt-Anchor" href="#特殊的mp4-fmp4"></a> 特殊的MP4-fMP4</h4><p>MP4 的基本组成单位是 box</p><h5 id="box类型有很多"><a class="markdownIt-Anchor" href="#box类型有很多"></a> box类型有很多</h5><ul><li>ftyp：File Type Box，描述文件遵从的MP4规范与版本；</li><li>moov：Movie Box，媒体的<code>metadata</code>信息（包含的 trak 记录着<code>视频播放数据的时间</code>和<code>空间信息</code>），有且仅有一个。</li><li>mdat：Media Data Box，存放实际的媒体数据(保存着视频音频信息)，一般有多个；</li></ul><p>播放MP4的过程：</p><ul><li>播放器在播放MP4 的时候，需要先读取<code>metadata</code>，然后再读取媒体数据。才可以播放</li><li>视频的拖动，快进，都是需要根据 <code>moov metadata</code> 和拖动至的时间。</li><li>但是 MP4文件，不一定 moov 就在文件开头，也有可能在文件末尾。</li><li>本地MP4文件，可以快速读取整个文件，找到<code>metadata</code>后，开始播放，</li><li>但是 网络上的MP4文件 如果开头找不到 <code>moov metadata</code> ，就只能等下载完毕，才能播放。</li></ul><blockquote><p>要实现 网络上的MP4文件边下边播，就需要<strong>将<code>moov metadata</code> 放在文件开头</strong>。</p></blockquote><p><a href="https://www.cnblogs.com/chyingp/p/mp4-file-format.html">使用HTTP流播放MP4</a></p><h3 id="webrtcweb-real-time-communication"><a class="markdownIt-Anchor" href="#webrtcweb-real-time-communication"></a> WebRTC（Web Real-Time Communication）</h3><p>WebRTC是网页 实时通信</p><ul><li>一个<strong>支持网页浏览器</strong> 进行<strong>实时语音对话</strong>或<strong>视频对话</strong>的技术而无需任何插件。</li><li>兼容性好： WebRTC已经不仅仅局限于PC的网页浏览器，<strong>Android、iOS平台</strong>上很多应用都已经采用了这样技术。</li><li>使用是<strong>RTP分装码流</strong>，建立通信后，会不断以流式发送数据，所以延迟会比<code>RTMP</code>还要低。可以达到1秒内</li><li>WebRTC协议 支持 推流 和 拉流，地址一般是以 <code>webrtc://</code>开头的，且 推流和拉流地址一般也是一样的。</li><li>应用在直播场景的话，是需要搭建 <strong>WebRTC服务器</strong>作为 流媒体服务的，流媒体服务软件可以使用<code>SRS</code>。</li></ul><p>SRS是国内研发的一个比较流行的开源流媒体服务软件:<br><a href="https://ossrs.io">https://ossrs.io</a><br><a href="https://ossrs.net">https://ossrs.net</a><br><a href="https://github.com/ossrs/srs">https://github.com/ossrs/srs</a></p><blockquote><p>WebRTC跟视频监控，IPTV，会议电视一样都是<code>RTP承载媒体流</code>，<br>WebRTC的码流采用<code>SRTP进行加密</code>，WebRTC优先使用<code>VP9、VP8、H.264</code>，不支持<code>H.265</code>。<br>WebRTC<strong>信令遵守ICE框架</strong>，使用 <strong>自定义信令</strong></p><p><code>IPTV</code>领域 使用<code>RTSP信令</code><br>视频监控走<code>GB28181</code>或者<code>onvif信令</code>，<br>会议电视走<code>h323</code>或<code>SIP协议</code>。</p></blockquote><h3 id="srt"><a class="markdownIt-Anchor" href="#srt"></a> SRT</h3><blockquote><p><code>UDT</code>协议</p><ul><li>基于<code>UDP</code>的传输协议，具有非常良好的<strong>丢包重传机制</strong>，丢包重传的控制消息非常丰富，同时支持ACK、ACKACK、NACK。</li><li>引入新的拥塞控制和数据可靠性控制机制</li><li>是面向连接的双向的应用层协议</li></ul></blockquote><p>SRT是基于<code>UDT</code>的协议,针对音视频实时性提出的协议。<br>SRT拥有三大特点，<strong>安全</strong>，<strong>可靠</strong>，<strong>低延迟</strong>。</p><ul><li>安全方面，SRT支持AES加密，保障端到端的视频传输安全。</li><li>可靠性方面，SRT通过前向纠正技术(FEC)保证传输的稳定性。</li><li>低延迟方面，由于SRT建立在<code>UDT</code>协议之上，解决了<code>UDT</code>协议传输延迟高和复杂的传输时序问题，可以做到支持高吞吐量文件和超清视频的实时传输。</li></ul><p><img src="/images/rtc/srt.jpg" alt="network_architecture.jpg"></p><blockquote><p>SRT协议具有抗丢包、抗拥塞、抗抖动等特性<br>SRT基于时间的报文发送，使其具有良好的防止流量突发的能力。<br>音视频流经过网络传输，帧间隔和码率特性会被完全改变，解码这样的信号容易出现故障。<br>而SRT增加了纠错协议，在封装中包含精准的时间戳，解码接收端可以通过该时间戳重现固定的帧间隔。<br>还能通过规定延时量，同时划定send buffer（发送端缓冲区）与receive buffer（接收端缓冲区），来自接收端的反馈信号（可以理解为后向纠错）通过一系列的设置、纠错、流量控制，使编码后的视音频码流拥有与原码流几乎一样的码率特性。</p></blockquote><p>推荐阅读：<br><a href="https://blog.csdn.net/fengliang191/article/details/120813885">流媒体传输协议浅析</a><br><a href="https://blog.csdn.net/weixin_36829761/article/details/136432050">HLS、FLV、RTMP三种协议快速对比</a><br><a href="https://www.cnblogs.com/yangchin9/p/18153222">直播协议详解 RTMP、HLS、HTTP-FLV、WebRTC、RTSP</a><br><a href="https://www.cnblogs.com/yangchin9/p/14930995.html">直播原理解析</a></p></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="http://mcdowell8023.github.io/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/" title="常见流媒体协议介绍" target="_blank" rel="external">http://mcdowell8023.github.io/2022/06/15/rtc/%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/mcdowell8023" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/mcdowell8023" target="_blank"><span class="text-dark">mcdowell</span><small class="ml-1x">Web 前端 &amp; 90后</small></a></h3><div>一线前端从业人员。</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2023/12/01/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E7%9A%84HTTP%E8%AF%B7%E6%B1%82/" title="网络协议-浏览器中的HTTP请求"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2022/05/28/%E5%B7%A5%E5%85%B7/svn/" title="SVN - 常用命令"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/mcdowell8023" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="https://www.linkedin.com/in/%E6%98%BE%E8%B6%85-%E5%AD%9F-688582107/" target="_blank" title="Linkedin" data-toggle="tooltip" data-placement="top"><i class="icon icon-linkedin"></i></a></li><li><a href="https://mcdowell8023.gitee.io/" target="_blank" title="Coding" data-toggle="tooltip" data-placement="top"><i class="icon icon-coding"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright">&copy; 2025 mcdowell<div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"",appKey:"",placeholder:"Just go go",avatar:"mm",meta:meta,pageSize:"10",visitor:!1})</script></body></html>